<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NPS.AI - 店舗設定</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="text-slate-800">

    <div class="flex h-screen bg-slate-50">
        <aside id="sidebar-container" class="w-72 lg:w-64 bg-white shadow-md flex-shrink-0 flex flex-col non-printable fixed inset-y-0 left-0 z-40 transform -translate-x-full lg:static lg:translate-x-0 transition-transform duration-300 ease-in-out">
            <div class="flex-grow flex items-center justify-center">
                <i class="fa-solid fa-spinner fa-spin text-blue-500"></i>
            </div>
        </aside>

        <main class="flex-1 flex flex-col overflow-hidden non-printable admin-main">
            <header class="h-16 bg-white border-b flex items-center justify-between px-4 lg:px-6 shadow-sm">
                
                <button id="sidebar-toggle-btn" class="lg:hidden text-slate-600 hover:text-slate-800">
                    <i class="fa-solid fa-bars fa-lg"></i>
                </button>

                <h2 id="page-title" class="text-xl font-semibold text-slate-700 hidden lg:block">店舗設定</h2>
                <h2 class="text-xl font-semibold text-slate-700 lg:hidden absolute left-1/2 -translate-x-1/2">
                    店舗設定
                </h2>

                <div class="hidden lg:flex items-center space-x-4">
                    <div class="flex items-center space-x-2 px-3 py-2 rounded-lg bg-slate-100 border border-slate-200">
                        <i class="fa-solid fa-store text-slate-500"></i>
                        <span id="header-store-name" class="text-sm font-semibold text-slate-700">loading...</span>
                    </div>
                    <button class="text-slate-500 hover:text-blue-600">
                        <i class="fa-regular fa-bell fa-lg"></i>
                    </button>
                </div>
                
                <div class="lg:hidden w-8"></div>
            </header>
            
            <div class="flex-1 overflow-y-auto p-4 lg:p-8">
                
                <div id="settings-page" class="max-w-6xl mx-auto">
                    
                    <div class="border-b responsive-tabs-container mb-6">
                        <div class="flex space-x-2" id="settings-tabs">
                            <button class="ranking-type-btn active" data-tab="tab-store">
                                <i class="fa-solid fa-store mr-1"></i> 店舗情報
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-rates">
                                <i class="fa-solid fa-percentage mr-1"></i> 料金・税
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-receipt">
                                <i class="fa-solid fa-receipt mr-1"></i> 領収書
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-tables">
                                <i class="fa-solid fa-chair mr-1"></i> テーブル
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-call">
                                <i class="fa-solid fa-champagne-glasses mr-1"></i> コール
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-first-visit">
                                <i class="fa-solid fa-user-check mr-1"></i> 初回設定
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-nfc">
                                <i class="fa-solid fa-wifi mr-1"></i> NFC打刻
                            </button>
                            <button class="ranking-type-btn" data-tab="tab-other">
                                <i class="fa-solid fa-ellipsis mr-1"></i> その他
                            </button>
                        </div>
                    </div>

                    <div id="settings-tab-content">
                        
                        <div id="tab-store" class="tab-content active space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">店舗情報</h3>
                                <form id="store-info-form" class="space-y-4 max-w-lg">
                                    <div>
                                        <label for="storeName" class="text-sm font-semibold text-slate-600">店舗名</label>
                                        <input type="text" id="storeName" class="w-full p-2 border border-slate-300 rounded-lg mt-1">
                                    </div>
                                    <div>
                                        <label for="storeZip" class="text-sm font-semibold text-slate-600">郵便番号</label>
                                        <input type="text" id="storeZip" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="例: 160-0021">
                                    </div>
                                    <div>
                                        <label for="storeAddress" class="text-sm font-semibold text-slate-600">住所</label>
                                        <input type="text" id="storeAddress" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="例: 東京都新宿区歌舞伎町1-1-1">
                                    </div>
                                    <div>
                                        <label for="storeTel" class="text-sm font-semibold text-slate-600">電話番号</label>
                                        <input type="tel" id="storeTel" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="例: 03-0000-0000">
                                    </div>
                                    <button type="submit" id="save-store-info-btn" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">
                                        保存する
                                    </button>
                                    <p id="store-info-feedback" class="text-sm"></p>
                                </form>
                            </div>
                        </div>

                        <div id="tab-rates" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">料金・税設定</h3>
                                <form id="rates-form" class="space-y-4 max-w-lg">
                                    <div class="grid grid-cols-2 gap-4">
                                        <div>
                                            <label for="taxRate" class="text-sm font-semibold text-slate-600">消費税率 (%)</label>
                                            <input type="number" id="taxRate" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="10">
                                        </div>
                                        <div>
                                            <label for="serviceRate" class="text-sm font-semibold text-slate-600">サービス料率 (%)</label>
                                            <input type="number" id="serviceRate" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="20">
                                        </div>
                                    </div>
                                    <div>
                                        <label for="dayChangeTime" class="text-sm font-semibold text-slate-600">営業日切替時刻</label>
                                        <input type="time" id="dayChangeTime" class="w-full p-2 border border-slate-300 rounded-lg mt-1">
                                    </div>
                                    <div>
                                        <label for="roundingType" class="text-sm font-semibold text-slate-600">端数処理</label>
                                        <select id="roundingType" class="w-full p-2 border border-slate-300 rounded-lg mt-1 bg-white">
                                            <option value="none">端数処理なし (1円単位)</option>
                                            <option value="round_down_total">合計金額を切り捨て</option>
                                            <option value="round_up_total">合計金額を切り上げ</option>
                                            <option value="round_up_subtotal">小計を切り上げ (税/サ計算前)</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label for="roundingUnit" class="text-sm font-semibold text-slate-600">端数処理単位 (円)</label>
                                        <input type="number" id="roundingUnit" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="10">
                                    </div>
                                    <button type="submit" id="save-rates-btn" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">
                                        保存する
                                    </button>
                                    <p id="rates-feedback" class="text-sm"></p>
                                </form>
                            </div>
                        </div>

                        <div id="tab-receipt" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">領収書設定</h3>
                                <form id="receipt-form" class="space-y-4 max-w-lg">
                                    <div>
                                        <label for="receiptStoreName" class="text-sm font-semibold text-slate-600">領収書に記載する店舗名</label>
                                        <input type="text" id="receiptStoreName" class="w-full p-2 border border-slate-300 rounded-lg mt-1">
                                    </div>
                                    <div>
                                        <label for="receiptAddress" class="text-sm font-semibold text-slate-600">住所 (改行は &lt;br&gt;)</label>
                                        <input type="text" id="receiptAddress" class="w-full p-2 border border-slate-300 rounded-lg mt-1">
                                    </div>
                                    <div>
                                        <label for="receiptTel" class="text-sm font-semibold text-slate-600">電話番号</label>
                                        <input type="tel" id="receiptTel" class="w-full p-2 border border-slate-300 rounded-lg mt-1">
                                    </div>
                                    <div>
                                        <label for="receiptInvoiceNumber" class="text-sm font-semibold text-slate-600">インボイス登録番号 (任意)</label>
                                        <input type="text" id="receiptInvoiceNumber" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="T1234567890">
                                    </div>
                                    <div>
                                        <label for="receiptDefaultDescription" class="text-sm font-semibold text-slate-600">但し書き (デフォルト)</label>
                                        <input type="text" id="receiptDefaultDescription" class="w-full p-2 border border-slate-300 rounded-lg mt-1" value="お飲食代として">
                                    </div>
                                    <button type="submit" id="save-receipt-btn" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">
                                        保存する
                                    </button>
                                    <p id="receipt-feedback" class="text-sm"></p>
                                </form>
                            </div>
                        </div>

                        <div id="tab-tables" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">テーブル設定</h3>
                                <form id="new-table-form" class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 mb-4 max-w-lg">
                                    <input type="text" id="new-table-name-input" placeholder="新しいテーブル名 (例: V3)" class="w-full p-2 border border-slate-300 rounded-lg">
                                    <button type="submit" id="add-table-btn" class="px-5 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 whitespace-nowrap">
                                        <i class="fa-solid fa-plus mr-2"></i>追加
                                    </button>
                                </form>
                                <p id="table-feedback" class="text-sm mb-4"></p>
                                <div id="current-tables-list" class="flex flex-wrap gap-3">
                                    </div>
                            </div>
                        </div>

                        <div id="tab-call" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">シャンパンコール設定</h3>
                                <form id="new-call-border-form" class="mb-4 space-y-3">
                                    <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                                        <input type="text" id="newCallName" placeholder="コール名 (例: ロングコール)" class="w-full p-2 border border-slate-300 rounded-lg">
                                        <input type="number" id="newCallBorder" placeholder="金額 (円単位、例: 150000)" class="w-full p-2 border border-slate-300 rounded-lg">
                                    </div>
                                    <button type="submit" id="addCallBorderBtn" class="px-5 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700 whitespace-nowrap">
                                        <i class="fa-solid fa-plus mr-2"></i>コールルール追加
                                    </button>
                                </form>
                                <p id="call-feedback" class="text-sm mb-4"></p>
                                
                                <h4 class="font-semibold mb-3">現在のコールルール一覧</h4>
                                <div id="call-border-list" class="space-y-2">
                                    </div>
                            </div>
                        </div>
                        
                        <div id="tab-first-visit" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">初回指名設定</h3>
                                <form id="first-visit-form" class="space-y-4 max-w-lg">
                                    <div>
                                        <label for="maxPhotoNominations" class="text-sm font-semibold text-slate-600">写真指名の最大人数</label>
                                        <input type="number" id="maxPhotoNominations" class="w-full p-2 border border-slate-300 rounded-lg mt-1" value="1" min="1">
                                        <p class="text-xs text-slate-500 mt-1">初回のお客様が写真で指名できるキャストの最大人数。</p>
                                    </div>
                                    <div>
                                        <label for="maxSendNominations" class="text-sm font-semibold text-slate-600">送り指名の最大人数</label>
                                        <input type="number" id="maxSendNominations" class="w-full p-2 border border-slate-300 rounded-lg mt-1" value="1" min="1">
                                        <p class="text-xs text-slate-500 mt-1">初回のお客様が最後に選べる送り指名の最大人数。</p>
                                    </div>
                                    <button type="submit" id="save-first-visit-btn" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">
                                        保存する
                                    </button>
                                    <p id="first-visit-feedback" class="text-sm"></p>
                                </form>
                            </div>
                        </div>

                        <div id="tab-nfc" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">NFC打刻設定</h3>
                                <form id="nfc-form" class="space-y-4 max-w-lg">
                                    <p class="text-sm text-slate-600">
                                        Web NFC対応のブラウザ (AndroidのChromeなど) でNFCタグをスキャンし、タグのシリアル番号を設定してください。
                                    </p>
                                    <div>
                                        <label for="nfcClockInTagId" class="text-sm font-semibold text-slate-600">出勤用タグ ID (シリアル番号)</label>
                                        <div class="flex space-x-2">
                                            <input type="text" id="nfcClockInTagId" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="スキャンして設定...">
                                            <button type="button" id="scanNfcClockInBtn" class="px-4 py-2 rounded-lg bg-white text-slate-700 font-semibold border border-slate-300 hover:bg-slate-100 mt-1 whitespace-nowrap">
                                                <i class="fa-solid fa-wifi"></i> スキャン
                                            </button>
                                        </div>
                                    </div>
                                    <div>
                                        <label for="nfcClockOutTagId" class="text-sm font-semibold text-slate-600">退勤用タグ ID (シリアル番号)</label>
                                        <div class="flex space-x-2">
                                            <input type="text" id="nfcClockOutTagId" class="w-full p-2 border border-slate-300 rounded-lg mt-1" placeholder="出勤用と同じIDで1タグ運用も可能">
                                            <button type="button" id="scanNfcClockOutBtn" class="px-4 py-2 rounded-lg bg-white text-slate-700 font-semibold border border-slate-300 hover:bg-slate-100 mt-1 whitespace-nowrap">
                                                <i class="fa-solid fa-wifi"></i> スキャン
                                            </button>
                                        </div>
                                    </div>
                                    <p id="nfc-scan-feedback" class="text-sm text-blue-600"></p>
                                    <button type="submit" id="save-nfc-btn" class="px-6 py-2 rounded-lg bg-blue-600 text-white font-semibold hover:bg-blue-700">
                                        保存する
                                    </button>
                                    <p id="nfc-feedback" class="text-sm"></p>
                                </form>
                            </div>
                        </div>
                        
                        <div id="tab-other" class="tab-content hidden space-y-6">
                            <div class="bg-white p-6 rounded-xl shadow-lg border border-slate-200">
                                <h3 class="text-lg font-semibold mb-5 border-b pb-3">アカウント操作</h3>
                                <button id="logoutBtn" class="px-6 py-2 rounded-lg bg-red-600 text-white font-semibold hover:bg-red-700">
                                    ログアウト
                                </button>
                            </div>
                        </div>

                    </div>
                </div>
                
            </div>
        </main>
    </div>

    <script type="module" src="sidebar.js"></script>
    <script type="module" src="settings.js"></script>
</body>
</html>